SELECT
	ToProper(sw.Text) as SourceWord,
	ToProper(tw.Text) as TargetWord,
	Avg(sw.Id) as Average,
	Count(0) as CountOf
FROM
	TestData:WordList:Word as sw
INNER JOIN TestData:WordList:Language as sl
	ON sl.Id = sw.LanguageId
INNER JOIN TestData:WordList:Synonym as s
	ON s.SourceWordId = sw.Id
INNER JOIN TestData:WordList:Word as tw
	ON tw.Id = s.TargetWordId
INNER JOIN TestData:WordList:Language as tl
	ON tl.Id = tw.LanguageId
WHERE
	sw.Text = 'Cat'
	OR sw.Text = 'Chow'
GROUP BY
	sw.Text,
	tw.Text
ORDER BY
	Avg(sw.Id / 60) asc,
	sw.Text desc,
	tw.Text desc

#Expected(EnforceRowOrder=false)
{
SourceWord	TargetWord	Average	CountOf
cat	Felino	590440	4
cat	Catlike	590440	1
cat	Feline	590440	1
cat	Gato	590440	2
cat	Féline	590440	2
cat	Katze	590440	1
cat	katzenhaft	590440	1
cat	Kissapeto	590440	3
cat	kissamainen	590440	3
chow	Chowder	593016	1
chow	Chaudrée	593016	1
chow	Chow	658594.5	2
}
